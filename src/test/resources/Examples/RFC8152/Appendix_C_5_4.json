{
   "title":"MAC example with multiple recipients",
   "input":{
      "plaintext":"This is the content.",
      "mac":{
         "protected":{
            "alg":"HS256"
         },
         "recipients":[
            {
               "key":{
                  "kty":"EC",
                  "kid":"bilbo.baggins@hobbiton.example",
                  "use":"enc",
                  "crv":"P-521",
                  "x":"AHKZLLOsCOzz5cY97ewNUajB957y-C-U88c3v13nmGZx6sYl_oJXu9A5RkTKqjqvjyekWF-7ytDyRXYgCF5cj0Kt",
                  "y":"AdymlHvOiLxXkEhayXQnNCvDX4h9htZaCJN34kfmC6pV5OhQHiraVySsUdaQkAgDPrwQrJmbnX9cwlGfP-HqHZR1",
                  "d":"AAhRON2r9cqXX1hg-RoI6R1tX5p2rUAYdmpHZoC1XNM56KtscrX6zbKipQrCW9CGZH3T4ubpnoTKLDYJ_fF3_rJt"
               },
               "protected":{
                  "alg":"ECDH-ES+A128KW"

               },
                "unsent":{
                    "compressed": 1
                }
            },
            {
               "unprotected":{
                  "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037",
                  "alg":"A256KW"
               },
               "key":{
                  "kty":"oct",
                  "kid":"018c0ae5-4d9b-471b-bfd6-eef314bc7037",
                  "use":"enc",
                  "k":"hJtXIZ2uSN5kbQfbtTNWbpdmhkV8FJG-Onbc6mxCcYg"
                }
            }
         ]
      },
      "rng_stream":[
         "2B7459201E5046E33FDB514C5E14A1B01D9893F8936335F821FCB1AFF450B226",
         "242773DB895E3E88FFE52628782CCD0C7457D91CCD1DAEE5A76C34F197DFD677E308F7620394503834DDDE67F5D823B9881A0A6A067FFAF10AC05DAE0AF7CCD07542"
      ]
   },
   "intermediates":{
      "ToMac_hex":"84634D414343A101054054546869732069732074686520636F6E74656E742E",
      "CEK_hex":"2B7459201E5046E33FDB514C5E14A1B01D9893F8936335F821FCB1AFF450B226",
      "recipients":[
         {
            "Context_hex":"842283F6F6F683F6F6F682188044A101381C",
            "Secret_hex":"000624B09A73EAD64AE07C0EBDA18126F02C80720DA239C8643198DBC1A10F967E5183D915678503CB78808F831AED26FF7D0F1E638AC58CD398E2AD00AC8A9B56E6",
            "KEK_hex":"5616902BF2724077A3EC013EAE1E98E5"
         },
         {
         }
      ]
   },
   "output":{
      "cbor_diag":"97([h'A10105', {}, h'546869732069732074686520636F6E74656E742E', h'BF48235E809B5C42E995F2B7D5FA13620E7ED834E337F6AA43DF161E49E9323E', [[h'A101381C', {-1: {1: 2, -1: 3, -2: h'0043B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C3', -3: true}, 4: h'62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C65'}, h'339BC4F79984CDC6B3E6CE5F315A4C7D2B0AC466FCEA69E8C07DFBCA5BB1F661BC5F8E0DF9E3EFF5'], [h'', {1: -5, 4: h'30313863306165352D346439622D343731622D626664362D656566333134626337303337'}, h'0B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB']]])",
      "cbor":"D8618543A10105A054546869732069732074686520636F6E74656E742E5820BF48235E809B5C42E995F2B7D5FA13620E7ED834E337F6AA43DF161E49E9323E828344A101381CA220A4010220032158420043B12669ACAC3FD27898FFBA0BCD2E6C366D53BC4DB71F909A759304ACFB5E18CDC7BA0B13FF8C7636271A6924B1AC63C02688075B55EF2D613574E7DC242F79C322F504581E62696C626F2E62616767696E7340686F626269746F6E2E6578616D706C655828339BC4F79984CDC6B3E6CE5F315A4C7D2B0AC466FCEA69E8C07DFBCA5BB1F661BC5F8E0DF9E3EFF58340A2012404582430313863306165352D346439622D343731622D626664362D65656633313462633730333758280B2C7CFCE04E98276342D6476A7723C090DFDD15F9A518E7736549E998370695E6D6A83B4AE507BB"
   }
}
